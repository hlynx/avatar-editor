/*!
 * AvatarEditor v1.0.0
 * https://github.com/hlynx/avatar-editor.git
 * Copyright 2014 hlynx <hlynx@users.noreply.github.com>
 */
angular.module("avatarEditor",["ngImgCrop"]).directive("avatarEditor",["$log",function(a){return{restrict:"EA",replace:!0,scope:{src:"@"},template:'<div class="avatar-editor">            <img-crop class="ng-img-crop" ng-show="stage == 2" data-image="resultSrc" data-result-image="croppedSrc" data-area-type="square" data-area-min-size="100"></img-crop>            <label  ng-show="stage == 1">                <img ng-src="{{src}}">                <input type="file">            </label>            <div class="avatar-editor-buttons" ng-show="stage == 2">                <a class="avatar-editor-button-done glyphicon glyphicon-ok" ng-click="done()"></a>                <a class="avatar-editor-button-close glyphicon glyphicon-remove" ng-click="setStage1()"></a>            </div>        </div>',link:function(b,c){function d(b){var c=null,d=!1,e=b.children();for(var f in e)if("LABEL"==e[f].tagName){c=e[f];break}if(!c)return a.warn("avatarEditor: label not found"),!1;e=c.children;for(var f in e)if("INPUT"==e[f].tagName){d=e[f];break}return d}function e(a){var c=a.currentTarget.files[0],d=new FileReader;d.onload=function(a){b.$apply(function(b){b.resultSrc=a.target.result,b.setStage2()})},d.readAsDataURL(c)}b.resultSrc=b.src||"",b.croppedSrc="",b.setStage1=function(){b.stage=1},b.setStage2=function(){b.stage=2};var f=d(c);return f?(b.setStage1(),f.addEventListener("change",e),b.$on("$destroy",function(){f.removeEventListener("change",e)}),void(b.done=function(){b.src=b.croppedSrc,b.setStage1()})):void a.warn('avatarEditor: input[type="file"] not found')}}}]);